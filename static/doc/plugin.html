<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <title>YApi 接口管理平台 插件 Wiki</title>
    
        <meta name="keywords" content="api管理,接口管理,接口文档,api文档">
    
    
        <meta name="description" content="YApi 是高效、易用、功能强大的 api 管理平台，旨在为开发、产品、测试人员提供更优雅的接口管理服务。可以帮助开发者轻松创建、发布、维护 API，YApi 还为用户提供了优秀的交互体验，开发人员只需利用平台提供的接口数据写入工具以及简单的点击操作就可以实现接口的管理。">
    

    <link rel="shortcut icon" href="./images/favicon.ico" />
    <link rel="stylesheet" href="source/main.css" />
    
    
      
      <link rel="stylesheet" href="styles/theme.css" />
      
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta name="format-detection" content="telephone=no,email=no" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge, chrome=1">
</head>
<body>
    <div class="ydoc">
        <header class="ydoc-header">
            <div class="ydoc-header-area">
                
                <a href="./index.html" class="navbar-brand"><img src="./images/logo_header@2x.png" /> &nbsp;YAPI</a>
                
                <button class="ydocIcon navbar-toggle">&#xf020;</button>
                <nav class="ydoc-nav">
                    <ul class="navbar-left">
                         
                        <li class="">
                            
                            <a href="index.html"></a> 
                        </li>
                        
                        <li class="">
                            
                            <a href="usage.html">使用手册</a> 
                        </li>
                        
                        <li class="">
                            
                            <a href="devops.html">内网部署</a> 
                        </li>
                        
                        <li class="active">
                            
                            <a href="plugin.html">插件 Wiki</a> 
                        </li>
                        
                        <li class="">
                            
                            <a href="qa.html">常见问题</a> 
                        </li>
                        
                        <li class="">
                            
                            <a href="releases.html">版本记录</a> 
                        </li>
                        
                        <li class="">
                            
                            <a href="http://yapi.demo.qunar.com/" target="_blank">demo 站点</a> 
                        </li>
                        
                        <li class="">
                            
                            <a href="api.html"></a> 
                        </li>
                         
                    </ul>
                </nav>
            </div>
        </header>
        
        <!-- <header style="height:20px"></header> -->
        
        <!-- Docs page layout -->
        
        <div class="ydoc-banner-bg">
            <div class="ydoc-banner ">
                <div class="ydoc-banner-area">
                    <h1 >插件</h1>
                    <p class="desc ">可根据业务需求，定制化功能</p>
                    
                </div>
            </div>
            

            <div class="ydoc-container">
                 
                <div class="ydoc-container-content ">
                    
                    
                    <div class="content-left staticsidenav" role="complementary">
                        <nav class="docs-sidebar hidden-print hidden-xs hidden-sm">
                            <ul class="nav docs-sidenav">
                                 
                                <!-- <li  > -->
                                <li >
                                    
                                    <a href="redev.html">二次开发</a> 
                                </li>
                                  
                                <!-- <li  > -->
                                <li >
                                    
                                    <a href="plugin-index.html">插件管理</a> 
                                </li>
                                  
                                <!-- <li  > -->
                                <li >
                                    
                                    <a href="plugin-dev.html">插件开发</a> 
                                </li>
                                  
                                <!-- <li  > -->
                                <li >
                                    
                                    <a href="plugin-hooks.html">钩子列表</a> 
                                </li>
                                  
                                <!-- <li  > -->
                                <li >
                                    
                                    <a href="plugin-list.html">插件列表</a> 
                                </li>
                                 
                            </ul>
                        </nav>
                    </div>
                    
                    <div class="content-right markdown-body use-sidebar" role="main">

                         <h2 class="subject" id="安装环境">安装环境 <a class="hashlink" href="#安装环境">#</a></h2><p>安装 Node.js，<a target="_blank" href="https://nodejs.org/en/download/package-manager/">官方安装方法</a></p>
<pre><code class="lang-bash"><span class="token comment"># On RHEL, CentOS or Fedora, for Node.js v8 LTS:</span>
curl --silent --location https://rpm.nodesource.com/setup_8.x <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">bash</span> -
<span class="token comment"># Alternatively for Node.js 9:</span>
curl --silent --location https://rpm.nodesource.com/setup_9.x <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">bash</span> -
<span class="token comment"># 安装 Node.js</span>
<span class="token function">sudo</span> yum -y <span class="token function">install</span> nodejs
<span class="token comment"># Enterprise Linux（RHEL和CentOS）用户可以使用EPEL存储库中的Node.js和npm包。</span>
<span class="token comment"># 为您的版本安装相应的epel-release RPM（在EPEL存储库主页上找到），然后运行：</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> nodejs <span class="token function">npm</span> --enablerepo<span class="token operator">=</span>epel
</code></pre>
<p>安装构建工具，要从npm编译和安装本地插件，您可能还需要安装构建工具：</p>
<pre><code class="lang-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> gcc-c++ <span class="token function">make</span>
<span class="token comment"># or: sudo yum groupinstall 'Development Tools'</span>
</code></pre>
<p>安装 MongoDB，首先创建源，创建 <code>mongodb.repo</code> 文件, 
<a target="_blank" href="https://docs.mongodb.com/manual/installation/">官方安装方法</a></p>
<pre><code class="lang-bash"><span class="token comment"># 在/etc/yum.repos.d/目录下创建文件mongodb.repo，它包含MongoDB仓库的配置信息，内容如下：</span>
<span class="token comment"># 复制代码, 代码如下:</span>
<span class="token punctuation">[</span>mongodb<span class="token punctuation">]</span>
name<span class="token operator">=</span>MongoDB Repository
baseurl<span class="token operator">=</span>http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/
gpgcheck<span class="token operator">=</span>0
enabled<span class="token operator">=</span>1
</code></pre>
<p>yum 安装 MongoDB </p>
<pre><code>sudo yum install mongodb-org
</code></pre><p>为 YApi 初始数据库</p>
<pre><code class="lang-js">use yapi <span class="token comment">// 创建yapi数据库 </span>
db<span class="token punctuation">.</span>wong<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"kenny wong"</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 插入一条数据，将在数据库列表中展示</span>
show dbs <span class="token comment">// 查看所有数据库</span>
db<span class="token punctuation">.</span><span class="token function">addUser</span><span class="token punctuation">(</span><span class="token string">'yapi'</span><span class="token punctuation">,</span><span class="token string">'yapi321'</span><span class="token punctuation">)</span> <span class="token comment">// 老的，数据库加用户的命令</span>

db<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    user<span class="token punctuation">:</span> <span class="token string">"yapi"</span><span class="token punctuation">,</span>
    pwd<span class="token punctuation">:</span> <span class="token string">"yapi321"</span><span class="token punctuation">,</span>
    roles<span class="token punctuation">:</span>
    <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        role<span class="token punctuation">:</span> <span class="token string">"userAdminAnyDatabase"</span><span class="token punctuation">,</span>
        db<span class="token punctuation">:</span> <span class="token string">"yapi"</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
<h2 class="subject" id="安装YApi">安装YApi <a class="hashlink" href="#安装YApi">#</a></h2><p>1.创建工程目录</p>
<pre><code class="lang-bash"><span class="token function">mkdir</span> yapi <span class="token operator">&amp;&amp;</span> <span class="token function">cd</span> yapi
<span class="token function">git</span> clone https://github.com/YMFE/yapi.git vendors --depth<span class="token operator">=</span>1 <span class="token comment"># 或者下载 zip 包解压到 vendors 目录</span>
</code></pre>
<p>2.修改配置</p>
<pre><code class="lang-bash"><span class="token function">cp</span> vendors/config_example.json ./config.json <span class="token comment"># 复制完成后请修改相关配置</span>
<span class="token function">vi</span> ./config.json
</code></pre>
<p>配置如下，主要配置 MongoDB 数据库，以及 Admin 账号。</p>
<pre><code class="lang-json"><span class="token punctuation">{</span>
  <span class="token property">"port"</span><span class="token operator">:</span> <span class="token string">"3011"</span><span class="token punctuation">,</span>
  <span class="token property">"adminAccount"</span><span class="token operator">:</span> <span class="token string">"admin@admin.com"</span><span class="token punctuation">,</span>
  <span class="token property">"db"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"servername"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>
    <span class="token property">"DATABASE"</span><span class="token operator">:</span>  <span class="token string">"yapi"</span><span class="token punctuation">,</span>
    <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">27017</span><span class="token punctuation">,</span>
    <span class="token property">"user"</span><span class="token operator">:</span> <span class="token string">"yapi"</span><span class="token punctuation">,</span>
    <span class="token property">"pass"</span><span class="token operator">:</span> <span class="token string">"yapi123"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"mail"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"enable"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"host"</span><span class="token operator">:</span> <span class="token string">"smtp.163.com"</span><span class="token punctuation">,</span>
    <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">465</span><span class="token punctuation">,</span>
    <span class="token property">"from"</span><span class="token operator">:</span> <span class="token string">"***@163.com"</span><span class="token punctuation">,</span>
    <span class="token property">"auth"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"user"</span><span class="token operator">:</span> <span class="token string">"***@163.com"</span><span class="token punctuation">,</span>
        <span class="token property">"pass"</span><span class="token operator">:</span> <span class="token string">"*****"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>3.安装依赖</p>
<pre><code class="lang-bash"><span class="token function">cd</span> vendors
<span class="token function">npm</span> <span class="token function">install</span> --production --registry https://registry.npm.taobao.org <span class="token comment"># 安装依赖</span>
</code></pre>
<p>4.初始化</p>
<pre><code class="lang-bash"><span class="token function">npm</span> run install-server  <span class="token comment"># 安装程序会初始化数据库索引和管理员账号，管理员账号名可在 config.json 配置</span>
<span class="token comment"># 默认输出</span>
<span class="token comment"># 初始化管理员账号成功,账号名："admin@admin.com"，密码："ymfe.org"</span>
</code></pre>
<p>5.启动服务</p>
<pre><code class="lang-bash"><span class="token comment"># 后台启动，输出日志yapi.log</span>
node server/app.js <span class="token operator">>></span> yapi.log 2<span class="token operator">></span><span class="token operator">&amp;</span>1 <span class="token operator">&amp;</span> 
<span class="token comment"># 启动服务器后，请访问 127.0.0.1:{config.json配置的端口}，初次运行会有个编译的过程，请耐心等候</span>
<span class="token comment"># 127.0.0.1:3011</span>
</code></pre>
<p>目录结构</p>
<pre><code>|-- config.json
|-- init.lock
|-- log
|   `-- <span class="token number">2018</span>-<span class="token number">1</span>.log
`-- vendors
    |-- CHANGELOG.md
    |-- LICENSE
    |-- README.md
    |-- client
    |-- common
    |-- config_example.json
    |-- doc
    |-- exts
    |-- nodemon.json
    |-- npm-debug.log
    |-- package.json
    |-- plugin.json
    |-- server
    |-- static
    |-- test
    |-- webpack.alias.js
    |-- yapi-base-flow.jpg
    |-- ydocfile.js
    `-- ykit.config.js
</code></pre><h2 class="subject" id="技术栈说明">技术栈说明 <a class="hashlink" href="#技术栈说明">#</a></h2><p>后端： koa mongoose</p>
<p>前端： react redux</p>
<h2 class="subject" id="启动_prd_环境服务器">启动 prd 环境服务器 <a class="hashlink" href="#启动_prd_环境服务器">#</a></h2><pre><code>  cd vendors
  ykit pack -m
  node server/app.js
</code></pre>
                    </div>
                </div>
                 
            </div>
            
        </div>
        
        <footer class="footer">
            <div class="copyright">
                &copy; 2018 <a href="https://ymfe.org">YMFE</a> Team. Build by <a href="http://ued.qunar.com/ydoc/">ydoc</a>&nbsp;
            </div>
        </footer>
    </div>

    
    <div class="open-panel"></div>
    <div class="mask"></div>
     

    <script src="source/main.js"></script>
    <script src="source/app.js"></script>
        

    </body>

</html>
